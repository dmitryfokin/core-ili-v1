# core-ili-v1

## Реализация паттерна Item - Link - Item

## Цель

Цель: BackEND Реализовать API, получения данных. FrontEND Универсальный навигатор по данным.

Данный проект является учебным черновиком, и ни на что не претендует. 

## Паттерн Item - Link - Item (ILI)

В мире на 2020 год распространены два основных подхода хранения данных - реляционные СУБД и документоориентированные СУБД.
Есть круг задачь, которым не подходит оба типа СУБД. Например, PDM - системы, Экспертные системы. Т.е. задачи где может быть огромное количество смысловых сязей между понятиями, при этом однотипные смыслы могут немного отличатся друг от друга. Смыслы могут возникать каждый день при этом реализация в реаляционных СУБД представляет огромную сложность по мере роста смыслов.
Все эти вопросы должен решить паттерн ILI
Будем попробовать

### Сфера применения

* PDM PLM системы (машиностроение, приборостроение)
* Типография и издательство печатной продукции
* Интерактивная верстка сайтов
* Тайм менеджмент
* Регламентирование, планирование и ведение разработки программного обеспечения
* Базы знаний и экспертные системы

## Стек технологий

    full-stack: Javascript
        back-end: NodeJS + Express + PostgreSQL
        front-end: ???


## Структура данных

### Item

Item - элемент или объект, в самом широком смысле. Каждый элемент имеет тип. Набор атрибутов. Набор атрибутов неограничен, но набор по умолчанию, определяется в типе элемента

Пример: Автомобиль, материал, колесо, Элемент DOM дерева, задача, чеклист, пункт чеклиста.

### TypesItem

TypesItem - Типы элементов. Определяет:
* основные атрибуты элемента;
* основное правило формирования наименования элемента по атрибутам
* поведение элемента;
* типы связей в которых элемент может быть родителем, а в каких может быть потомком;
* условия уникальности;
* возможность хранения истории изменения
* возможность создания ревизий элементов

#### Поля таблицы

      'id', type: 'uuid' - id типа элемента
      'key', type: 'String' - ключ типа элемента (TODO: нужно определить формат) (по идее должен служить смысловой заменой id и быть уникальным) 
      'description', type: 'String' - Описание типа элемента
      'createdAt', type: 'Date' - дата создание записи
      'updatedAt', type: 'Date' - дата последнего изменения записи


### Link

Link - связь двух элементов. Связь - является, по сути, специальным объектом, который связывая два элемента имеет свой набор атрибутов. Так же Связь можно представить как **Смысл** соединения двух объектов.

Пример: PDM система
* Item{Деталь: Болт 8х40} - Link{Состав: Материал,Attributs{вес: 100, единица измереиня: г}} - Item{Материал: Кург AMG-10}
* Item{Деталь: Болт 8х80} - Link{Состав: Материал,Attributs{вес: 0.2, единица измереиня: кг}} - Item{Материал: Кург AMG-10}

### TypesLink

TypesLink - типы связей.

### Attribut

## Программный интрефейс

### Параметры

Параметры БД
prefix - префикс таблиц в БД,предварительно служит для разделения пространства данных


### Инициализация базы данных

1. Создаем базу данных
2. в файле core-ili-db-init.js определены массивы данных, для записи в базу данных
3. 

### Общий интерфейс команды

Класс CoreILIDB предоставляет функцию query в которую передается команда (объект) 'script'.

| REST    | action  | CRUD   | Описание                                |
| ------- | ------- | ------ | --------------------------------------- |
| index   | get     | read   | получение данных                        |
| show    | get     | read   |                                         |
| ------- | ------- | ------ | --------------------------------------- |
| new     | new     | create | получение структуры данных для создания |
| create  | create  | create | запись новых данных в БД                |
| ------- | ------- | ------ | --------------------------------------- |
| edit    | edit    | update | получение данных для изменения          |
| update  | update  | update | запись измененных данных в БД           |
| ------- | ------- | ------ | --------------------------------------- |
| destroy | destroy | delete |удаление данных                          |




скрипт является объектом, в котором передаеются либо одно дейсвие 

    `
    {  
      action: 'create',  
      type: 'TypeItem',  
      data: {  
        name: 'Task',  
        description: 'Task'  
      }  
    }
    `
    
, либо массив действий

    `
    {
      actions: [
        {
          action: 'create',  
          type: 'TypeItem',  
          data: {  
            name: 'Task',  
            description: 'Task'  
          }  
        },
        {
          action: 'create',  
          type: 'TypeItem',  
          data: {  
            name: 'Folder',  
            description: 'Folder'  
          }  
        },
      ]
    }
    `

### query(script)

Последовательность обработки действий

| пп    | Описание  | action   | type                                |
| ------- | ------- | ------ | --------------------------------------- |
| 1| Создание типа связи | create | TypeLink |
| 2| Обновление типа  связи| update | TypeLink |
| 3| Создание типа элемента| create | TypeItem |
| 4| Обновление типа элемента| update | TypeItem |
| 5| Создание элементов| create | Item |
| 6| Обновление элементов| update | Item |
| 7| Создание связей | create | Link |
| 8| Обновление сязей | update | Link |
| 9| Удаление сязей | destroy | Link |
|10| Удаление элементов | destroy | Item |
|11| Удаление типа элемента | destroy | TypeItem |
|12| Удаление типа связи | destroy | TypeLink |



### Поиск элемента

### Поиск элементов

### Входимость элемента

### Создать тип элемента

### Создать тип связи

### Создать элемент

### Создать связь

### Удалить тип элемента

### Удалить тип связи

### Удалить элемент

### Удалить связь

### Добавить атрибут

### Изменить атрибут

### Удалить атрибут

### Получить форму элемента

### Получить дерево данных

### Получить версию ядра

## Планы на следующие версии ядра

### core-ili-v2

* Добавить функционал структур данных. Структура - представляет собой объект - дерево элементов и связей различных типов со сложной, многоуровневой иерархией. Смысл функционала: один элемент может входить в разные структуры, и при изменении, должны пересчитаться данные во всех структурах. TODO: нужен развернутый пример.

### core-ili-v3

* Добавление функционала разделения доступа к элементам и связем

### core-ili-v4

???
